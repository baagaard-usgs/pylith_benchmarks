# ----------------------------------------------------------------------
# Create hex8 mesh at 100m resolution.
# ----------------------------------------------------------------------

# ----------------------------------------------------------------------
# Set parameters.
# ----------------------------------------------------------------------
playback 'params.jou'

# ----------------------------------------------------------------------
# Reset block dimensions to be a multiple of 1.8km
# ----------------------------------------------------------------------
#{blockWidth=129.6*km}
#{blockLength=129.6*km}
#{blockHeight=64.8*km}

# ----------------------------------------------------------------------
# Generate geometry
# ----------------------------------------------------------------------
playback 'geometry.jou'

# ----------------------------------------------------------------------
# Set discretization size
# ----------------------------------------------------------------------
volume all size {36*dx}
surface 21 23 26 28 scheme pave
volume 3 scheme sweep source 21 target 23
volume 5 scheme sweep source 26 target 28

# ----------------------------------------------------------------------
# Generate the mesh
# ----------------------------------------------------------------------
mesh volume all

# ----------------------------------------------------------------------
# Refine cells near rupture
# ----------------------------------------------------------------------
playback 'refinecells.jou'

# Refine to get final resolution
refine volume all numsplit 1

# ----------------------------------------------------------------------
# Smooth mesh to improve quality
# ----------------------------------------------------------------------
volume all smooth scheme condition number beta 1.3 cpu 10
smooth volume all

# ----------------------------------------------------------------------
# Setup boundary conditions.
# ----------------------------------------------------------------------
playback 'createbc.jou'

# ----------------------------------------------------------------------
# Export exodus file
# ----------------------------------------------------------------------
export mesh "hex8_100m.exo" dimension 3 overwrite






