# ----------------------------------------------------------------------
# Generate geometry.
# ----------------------------------------------------------------------
playback 'geometry_tet4.jou'

# ----------------------------------------------------------------------
# Set mesh discretization.
# ----------------------------------------------------------------------
playback 'tet_sizing.jou'

# ----------------------------------------------------------------------
# Generate mesh.
# ----------------------------------------------------------------------
mesh volume all

# ----------------------------------------------------------------------
# Smooth mesh to improve quality
# ----------------------------------------------------------------------
${condnum=1.9}
${loop(4)}
cleanup volume all
volume all smooth scheme condition number beta {condnum} cpu 1
smooth volume all
${condnum=condnum-0.1}
${endloop}

# ----------------------------------------------------------------------
# Generate blocks and nodelists.
# ----------------------------------------------------------------------
playback 'bc_tet4.jou'

# ----------------------------------------------------------------------
# Export exodus file.
# ----------------------------------------------------------------------
set large exodus off
export mesh "dike-disloc_tet4_graded_2000m.exo" dimension 3 overwrite
